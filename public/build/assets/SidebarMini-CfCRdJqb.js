import{r as c,q as le,j as r,b as Ot,R as L,W as Ue,y as fe,a as ae,Y as _t}from"./app-2-nbgIXB.js";import{c as z}from"./clsx-B-dksMZM.js";import{s as Ge,l as B,o as E,O as ke,U as J,u as se,p as me,a as Mt,d as pe,x as He,C as Y,y as Z,b as Rt,c as Fe,q as Ve}from"./transition-BV2HJH_b.js";import{c as je,u as Nt,v as kt,w as Ke,q as Ft,j as At,r as Pt,x as Lt,y as Dt,o as $t,z as zt,s as Bt,p as Ut}from"./index-Dx4gZyUt.js";import{h as ie}from"./moment-C5S46NFB.js";import{o as Gt,y as Ht,u as qe,s as Ye,I as ee,n as Vt,m as Ae,b as $,t as Pe,r as We,c as Kt,a as qt,G as Yt,w as Wt,d as Xt}from"./Modal-ppMeCEZL.js";import{I as ne}from"./InputLabel-BOEoPHxE.js";import{I as X,T as Xe}from"./InputError-Bz1JaDdo.js";const Jt=e=>window.axios.get(`${route("chats.users")}?query=${e||""}`),Qt=()=>window.axios.get(`${route("chats.users")}?archived_chats=true`),Zt=()=>window.axios.get(route("chats.notification")),Jn=e=>window.axios.get(e),Qn=e=>window.axios.post(route("chats.mark_as_read",e.id)),Zn=e=>window.axios.post(route("chats.mark_as_unread",e.id)),eo=e=>window.axios.post(route("chats.archive",e.id)),to=e=>window.axios.post(route("chats.unarchive",e.id)),es=e=>window.axios.delete(route("chats.destroy_all",e.id)),ts=(e,s)=>window.axios.post(route("chats.customize_chat",e.id),{message_color:s}),Te={data:[],current_page:1,per_page:0,last_page:1,from:0,to:0,total:0,first_page_url:"",last_page_url:"string",next_page_url:"string",prev_page_url:"string"},Je={chats:[],paginate:Te,setChats:()=>{},setPaginate:()=>{},refetchChats:()=>{}},ss=(e,s)=>{switch(s.type){case"SET_CHATS":return{...e,chats:s.payload};case"SET_PAGINATE":return{...e,paginate:s.payload}}},Qe=c.createContext(Je),ge=()=>c.useContext(Qe),so=({children:e})=>{const s=le().props,[t,n]=c.useReducer(ss,Je),[o,a]=c.useState(!0),i=f=>n({type:"SET_CHATS",payload:f}),l=f=>n({type:"SET_PAGINATE",payload:f}),h=async()=>{const f=localStorage.getItem("last-sync-chats"),g=ie();if(!(f&&g.diff(ie(parseInt(f)))<3e3)){if(localStorage.setItem("last-sync-chats",g.valueOf().toString()),route().current("chats.*"))return Jt().then(b=>i(b.data.data.data));if(route().current("archived_chats.*"))return Qt().then(b=>i(b.data.data.data))}};c.useEffect(()=>{a(!1),i(s.chats.data),l(s.chats),window.Echo.channel("user-activity").listen(".user-activity",f=>{(Array.isArray(f.user)||(t.chats.length>0?t.chats:s.chats.data).find(u=>u.id===f.user.id))&&h()}),window.Echo.channel(`send-message-${s.auth.id}`).listen(".send-message",h)},[]);const d={...t,chats:o?s.chats.data:t.chats,paginate:o?s.chats:t.paginate,setChats:i,setPaginate:l,refetchChats:h};return r.jsx(Qe.Provider,{value:d,children:e})};function oe(e,s,t){let n=t.initialDeps??[],o;return()=>{var a,i,l,h;let d;t.key&&((a=t.debug)!=null&&a.call(t))&&(d=Date.now());const f=e();if(!(f.length!==n.length||f.some((u,p)=>n[p]!==u)))return o;n=f;let b;if(t.key&&((i=t.debug)!=null&&i.call(t))&&(b=Date.now()),o=s(...f),t.key&&((l=t.debug)!=null&&l.call(t))){const u=Math.round((Date.now()-d)*100)/100,p=Math.round((Date.now()-b)*100)/100,v=p/16,y=(x,j)=>{for(x=String(x);x.length<j;)x=" "+x;return x};console.info(`%câ± ${y(p,5)} /${y(u,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*v,120))}deg 100% 31%);`,t==null?void 0:t.key)}return(h=t==null?void 0:t.onChange)==null||h.call(t,o),o}}function we(e,s){if(e===void 0)throw new Error("Unexpected undefined");return e}const ns=(e,s)=>Math.abs(e-s)<1,os=(e,s)=>{let t;return function(...n){clearTimeout(t),t=setTimeout(()=>e.apply(this,n),s)}},rs=e=>e,as=e=>{const s=Math.max(e.startIndex-e.overscan,0),t=Math.min(e.endIndex+e.overscan,e.count-1),n=[];for(let o=s;o<=t;o++)n.push(o);return n},is=(e,s)=>{const t=e.scrollElement;if(!t)return;const n=a=>{const{width:i,height:l}=a;s({width:Math.round(i),height:Math.round(l)})};if(n(t.getBoundingClientRect()),typeof ResizeObserver>"u")return()=>{};const o=new ResizeObserver(a=>{const i=a[0];if(i!=null&&i.borderBoxSize){const l=i.borderBoxSize[0];if(l){n({width:l.inlineSize,height:l.blockSize});return}}n(t.getBoundingClientRect())});return o.observe(t,{box:"border-box"}),()=>{o.unobserve(t)}},Le={passive:!0},ls=typeof window>"u"?!0:"onscrollend"in window,cs=(e,s)=>{const t=e.scrollElement;if(!t)return;let n=0;const o=ls?()=>{}:os(()=>{s(n,!1)},e.options.isScrollingResetDelay),a=h=>()=>{n=t[e.options.horizontal?"scrollLeft":"scrollTop"],o(),s(n,h)},i=a(!0),l=a(!1);return l(),t.addEventListener("scroll",i,Le),t.addEventListener("scrollend",l,Le),()=>{t.removeEventListener("scroll",i),t.removeEventListener("scrollend",l)}},us=(e,s,t)=>{if(s!=null&&s.borderBoxSize){const n=s.borderBoxSize[0];if(n)return Math.round(n[t.options.horizontal?"inlineSize":"blockSize"])}return Math.round(e.getBoundingClientRect()[t.options.horizontal?"width":"height"])},ds=(e,{adjustments:s=0,behavior:t},n)=>{var o,a;const i=e+s;(a=(o=n.scrollElement)==null?void 0:o.scrollTo)==null||a.call(o,{[n.options.horizontal?"left":"top"]:i,behavior:t})};class hs{constructor(s){this.unsubs=[],this.scrollElement=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollDirection=null,this.scrollAdjustments=0,this.measureElementCache=new Map,this.observer=(()=>{let t=null;const n=()=>t||(typeof ResizeObserver<"u"?t=new ResizeObserver(o=>{o.forEach(a=>{this._measureElement(a.target,a)})}):null);return{disconnect:()=>{var o;return(o=n())==null?void 0:o.disconnect()},observe:o=>{var a;return(a=n())==null?void 0:a.observe(o,{box:"border-box"})},unobserve:o=>{var a;return(a=n())==null?void 0:a.unobserve(o)}}})(),this.range=null,this.setOptions=t=>{Object.entries(t).forEach(([n,o])=>{typeof o>"u"&&delete t[n]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:rs,rangeExtractor:as,onChange:()=>{},measureElement:us,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,...t}},this.notify=(t,n)=>{var o,a;const{startIndex:i,endIndex:l}=this.range??{startIndex:void 0,endIndex:void 0},h=this.calculateRange();(t||i!==(h==null?void 0:h.startIndex)||l!==(h==null?void 0:h.endIndex))&&((a=(o=this.options).onChange)==null||a.call(o,this,n))},this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(t=>t()),this.unsubs=[],this.scrollElement=null},this._didMount=()=>(this.measureElementCache.forEach(this.observer.observe),()=>{this.observer.disconnect(),this.cleanup()}),this._willUpdate=()=>{const t=this.options.getScrollElement();this.scrollElement!==t&&(this.cleanup(),this.scrollElement=t,this._scrollToOffset(this.scrollOffset,{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,n=>{this.scrollRect=n,this.notify(!1,!1)})),this.unsubs.push(this.options.observeElementOffset(this,(n,o)=>{this.scrollAdjustments=0,this.scrollDirection=o?this.scrollOffset<n?"forward":"backward":null,this.scrollOffset=n;const a=this.isScrolling;this.isScrolling=o,this.notify(a!==o,o)})))},this.getSize=()=>this.scrollRect[this.options.horizontal?"width":"height"],this.getMeasurementOptions=oe(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey],(t,n,o,a)=>(this.pendingMeasuredCacheIndexes=[],{count:t,paddingStart:n,scrollMargin:o,getItemKey:a}),{key:!1}),this.getFurthestMeasurement=(t,n)=>{const o=new Map,a=new Map;for(let i=n-1;i>=0;i--){const l=t[i];if(o.has(l.lane))continue;const h=a.get(l.lane);if(h==null||l.end>h.end?a.set(l.lane,l):l.end<h.end&&o.set(l.lane,!0),o.size===this.options.lanes)break}return a.size===this.options.lanes?Array.from(a.values()).sort((i,l)=>i.end===l.end?i.index-l.index:i.end-l.end)[0]:void 0},this.getMeasurements=oe(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:t,paddingStart:n,scrollMargin:o,getItemKey:a},i)=>{const l=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const h=this.measurementsCache.slice(0,l);for(let d=l;d<t;d++){const f=a(d),g=this.options.lanes===1?h[d-1]:this.getFurthestMeasurement(h,d),b=g?g.end+this.options.gap:n+o,u=i.get(f),p=typeof u=="number"?u:this.options.estimateSize(d),v=b+p,y=g?g.lane:d%this.options.lanes;h[d]={index:d,start:b,size:p,end:v,key:f,lane:y}}return this.measurementsCache=h,h},{key:!1,debug:()=>this.options.debug}),this.calculateRange=oe(()=>[this.getMeasurements(),this.getSize(),this.scrollOffset],(t,n,o)=>this.range=t.length>0&&n>0?fs({measurements:t,outerSize:n,scrollOffset:o}):null,{key:!1,debug:()=>this.options.debug}),this.getIndexes=oe(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(t,n,o,a)=>n===null?[]:t({startIndex:n.startIndex,endIndex:n.endIndex,overscan:o,count:a}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=t=>{const n=this.options.indexAttribute,o=t.getAttribute(n);return o?parseInt(o,10):(console.warn(`Missing attribute name '${n}={index}' on measured element.`),-1)},this._measureElement=(t,n)=>{const o=this.measurementsCache[this.indexFromElement(t)];if(!o||!t.isConnected){this.measureElementCache.forEach((l,h)=>{l===t&&(this.observer.unobserve(t),this.measureElementCache.delete(h))});return}const a=this.measureElementCache.get(o.key);a!==t&&(a&&this.observer.unobserve(a),this.observer.observe(t),this.measureElementCache.set(o.key,t));const i=this.options.measureElement(t,n,this);this.resizeItem(o,i)},this.resizeItem=(t,n)=>{const o=this.itemSizeCache.get(t.key)??t.size,a=n-o;a!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(t,a,this):t.start<this.scrollOffset+this.scrollAdjustments)&&this._scrollToOffset(this.scrollOffset,{adjustments:this.scrollAdjustments+=a,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(t.index),this.itemSizeCache=new Map(this.itemSizeCache.set(t.key,n)),this.notify(!0,!1))},this.measureElement=t=>{t&&this._measureElement(t,void 0)},this.getVirtualItems=oe(()=>[this.getIndexes(),this.getMeasurements()],(t,n)=>{const o=[];for(let a=0,i=t.length;a<i;a++){const l=t[a],h=n[l];o.push(h)}return o},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=t=>{const n=this.getMeasurements();return we(n[Ze(0,n.length-1,o=>we(n[o]).start,t)])},this.getOffsetForAlignment=(t,n)=>{const o=this.getSize();n==="auto"&&(t<=this.scrollOffset?n="start":t>=this.scrollOffset+o?n="end":n="start"),n==="start"?t=t:n==="end"?t=t-o:n==="center"&&(t=t-o/2);const a=this.options.horizontal?"scrollWidth":"scrollHeight",l=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[a]:this.scrollElement[a]:0)-this.getSize();return Math.max(Math.min(l,t),0)},this.getOffsetForIndex=(t,n="auto")=>{t=Math.max(0,Math.min(t,this.options.count-1));const o=we(this.getMeasurements()[t]);if(n==="auto")if(o.end>=this.scrollOffset+this.getSize()-this.options.scrollPaddingEnd)n="end";else if(o.start<=this.scrollOffset+this.options.scrollPaddingStart)n="start";else return[this.scrollOffset,n];const a=n==="end"?o.end+this.options.scrollPaddingEnd:o.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(a,n),n]},this.isDynamicMode=()=>this.measureElementCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&(clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(t,{align:n="start",behavior:o}={})=>{this.cancelScrollToIndex(),o==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(t,n),{adjustments:void 0,behavior:o})},this.scrollToIndex=(t,{align:n="auto",behavior:o}={})=>{t=Math.max(0,Math.min(t,this.options.count-1)),this.cancelScrollToIndex(),o==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const[a,i]=this.getOffsetForIndex(t,n);this._scrollToOffset(a,{adjustments:void 0,behavior:o}),o!=="smooth"&&this.isDynamicMode()&&(this.scrollToIndexTimeoutId=setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.measureElementCache.has(this.options.getItemKey(t))){const[h]=this.getOffsetForIndex(t,i);ns(h,this.scrollOffset)||this.scrollToIndex(t,{align:i,behavior:o})}else this.scrollToIndex(t,{align:i,behavior:o})}))},this.scrollBy=(t,{behavior:n}={})=>{this.cancelScrollToIndex(),n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.scrollOffset+t,{adjustments:void 0,behavior:n})},this.getTotalSize=()=>{var t;const n=this.getMeasurements();let o;return n.length===0?o=this.options.paddingStart:o=this.options.lanes===1?((t=n[n.length-1])==null?void 0:t.end)??0:Math.max(...n.slice(-this.options.lanes).map(a=>a.end)),o-this.options.scrollMargin+this.options.paddingEnd},this._scrollToOffset=(t,{adjustments:n,behavior:o})=>{this.options.scrollToFn(t,{behavior:o,adjustments:n},this)},this.measure=()=>{var t,n;this.itemSizeCache=new Map,(n=(t=this.options).onChange)==null||n.call(t,this,!1)},this.setOptions(s),this.scrollRect=this.options.initialRect,this.scrollOffset=typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset,this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(t=>{this.itemSizeCache.set(t.key,t.size)}),this.notify(!1,!1)}}const Ze=(e,s,t,n)=>{for(;e<=s;){const o=(e+s)/2|0,a=t(o);if(a<n)e=o+1;else if(a>n)s=o-1;else return o}return e>0?e-1:0};function fs({measurements:e,outerSize:s,scrollOffset:t}){const n=e.length-1,a=Ze(0,n,l=>e[l].start,t);let i=a;for(;i<n&&e[i].end<t+s;)i++;return{startIndex:a,endIndex:i}}const ps=typeof document<"u"?c.useLayoutEffect:c.useEffect;function ms(e){const s=c.useReducer(()=>({}),{})[1],t={...e,onChange:(o,a)=>{var i;a?Ot.flushSync(s):s(),(i=e.onChange)==null||i.call(e,o,a)}},[n]=c.useState(()=>new hs(t));return n.setOptions(t),c.useEffect(()=>n._didMount(),[]),ps(()=>n._willUpdate()),n}function gs(e){return ms({observeElementRect:is,observeElementOffset:cs,scrollToFn:ds,...e})}function Ie(e,s){let[t,n]=c.useState(e),o=Ge(e);return B(()=>n(o.current),[o,n,...s]),t}function et(e,s,t){let[n,o]=c.useState(t),a=e!==void 0,i=c.useRef(a),l=c.useRef(!1),h=c.useRef(!1);return a&&!i.current&&!l.current?(l.current=!0,i.current=a,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!a&&i.current&&!h.current&&(h.current=!0,i.current=a,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[a?e:n,E(d=>(a||o(d),s==null?void 0:s(d)))]}function De(e){var s;if(e.type)return e.type;let t=(s=e.as)!=null?s:"button";if(typeof t=="string"&&t.toLowerCase()==="button")return"button"}function tt(e,s){let[t,n]=c.useState(()=>De(e));return B(()=>{n(De(e))},[e.type,e.as]),B(()=>{t||s.current&&s.current instanceof HTMLButtonElement&&!s.current.hasAttribute("type")&&n("button")},[t,s]),t}function $e(e){return[e.screenX,e.screenY]}function xs(){let e=c.useRef([-1,-1]);return{wasMoved(s){let t=$e(s);return e.current[0]===t[0]&&e.current[1]===t[1]?!1:(e.current=t,!0)},update(s){e.current=$e(s)}}}function bs({container:e,accept:s,walk:t,enabled:n=!0}){let o=c.useRef(s),a=c.useRef(t);c.useEffect(()=>{o.current=s,a.current=t},[s,t]),B(()=>{if(!e||!n)return;let i=Gt(e);if(!i)return;let l=o.current,h=a.current,d=Object.assign(g=>l(g),{acceptNode:l}),f=i.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,d,!1);for(;f.nextNode();)h(f.currentNode)},[e,n,o,a])}function vs(e){throw new Error("Unexpected object: "+e)}var k=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(k||{});function ze(e,s){let t=s.resolveItems();if(t.length<=0)return null;let n=s.resolveActiveIndex(),o=n??-1;switch(e.focus){case 0:{for(let a=0;a<t.length;++a)if(!s.resolveDisabled(t[a],a,t))return a;return n}case 1:{for(let a=o-1;a>=0;--a)if(!s.resolveDisabled(t[a],a,t))return a;return n}case 2:{for(let a=o+1;a<t.length;++a)if(!s.resolveDisabled(t[a],a,t))return a;return n}case 3:{for(let a=t.length-1;a>=0;--a)if(!s.resolveDisabled(t[a],a,t))return a;return n}case 4:{for(let a=0;a<t.length;++a)if(s.resolveId(t[a],a,t)===e.id)return a;return n}case 5:return null;default:vs(e)}}function st(e={},s=null,t=[]){for(let[n,o]of Object.entries(e))ot(t,nt(s,n),o);return t}function nt(e,s){return e?e+"["+s+"]":s}function ot(e,s,t){if(Array.isArray(t))for(let[n,o]of t.entries())ot(e,nt(s,n.toString()),o);else t instanceof Date?e.push([s,t.toISOString()]):typeof t=="boolean"?e.push([s,t?"1":"0"]):typeof t=="string"?e.push([s,t]):typeof t=="number"?e.push([s,`${t}`]):t==null?e.push([s,""]):st(t,s,e)}function ys(e){var s,t;let n=(s=e==null?void 0:e.form)!=null?s:e.closest("form");if(n){for(let o of n.elements)if(o!==e&&(o.tagName==="INPUT"&&o.type==="submit"||o.tagName==="BUTTON"&&o.type==="submit"||o.nodeName==="INPUT"&&o.type==="image")){o.click();return}(t=n.requestSubmit)==null||t.call(n)}}var Cs={},Ss=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Ss||{}),ws=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(ws||{}),Es=(e=>(e[e.Pointer=0]="Pointer",e[e.Focus=1]="Focus",e[e.Other=2]="Other",e))(Es||{}),js=(e=>(e[e.OpenCombobox=0]="OpenCombobox",e[e.CloseCombobox=1]="CloseCombobox",e[e.GoToOption=2]="GoToOption",e[e.RegisterOption=3]="RegisterOption",e[e.UnregisterOption=4]="UnregisterOption",e[e.RegisterLabel=5]="RegisterLabel",e[e.SetActivationTrigger=6]="SetActivationTrigger",e[e.UpdateVirtualOptions=7]="UpdateVirtualOptions",e))(js||{});function Ee(e,s=t=>t){let t=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,n=s(e.options.slice()),o=n.length>0&&n[0].dataRef.current.order!==null?n.sort((i,l)=>i.dataRef.current.order-l.dataRef.current.order):qt(n,i=>i.dataRef.current.domRef.current),a=t?o.indexOf(t):null;return a===-1&&(a=null),{options:o,activeOptionIndex:a}}let Ts={1(e){var s;return(s=e.dataRef.current)!=null&&s.disabled||e.comboboxState===1?e:{...e,activeOptionIndex:null,comboboxState:1}},0(e){var s,t;if((s=e.dataRef.current)!=null&&s.disabled||e.comboboxState===0)return e;if((t=e.dataRef.current)!=null&&t.value){let n=e.dataRef.current.calculateIndex(e.dataRef.current.value);if(n!==-1)return{...e,activeOptionIndex:n,comboboxState:0}}return{...e,comboboxState:0}},2(e,s){var t,n,o,a,i;if((t=e.dataRef.current)!=null&&t.disabled||(n=e.dataRef.current)!=null&&n.optionsRef.current&&!((o=e.dataRef.current)!=null&&o.optionsPropsRef.current.static)&&e.comboboxState===1)return e;if(e.virtual){let f=s.focus===k.Specific?s.idx:ze(s,{resolveItems:()=>e.virtual.options,resolveActiveIndex:()=>{var b,u;return(u=(b=e.activeOptionIndex)!=null?b:e.virtual.options.findIndex(p=>!e.virtual.disabled(p)))!=null?u:null},resolveDisabled:e.virtual.disabled,resolveId(){throw new Error("Function not implemented.")}}),g=(a=s.trigger)!=null?a:2;return e.activeOptionIndex===f&&e.activationTrigger===g?e:{...e,activeOptionIndex:f,activationTrigger:g}}let l=Ee(e);if(l.activeOptionIndex===null){let f=l.options.findIndex(g=>!g.dataRef.current.disabled);f!==-1&&(l.activeOptionIndex=f)}let h=s.focus===k.Specific?s.idx:ze(s,{resolveItems:()=>l.options,resolveActiveIndex:()=>l.activeOptionIndex,resolveId:f=>f.id,resolveDisabled:f=>f.dataRef.current.disabled}),d=(i=s.trigger)!=null?i:2;return e.activeOptionIndex===h&&e.activationTrigger===d?e:{...e,...l,activeOptionIndex:h,activationTrigger:d}},3:(e,s)=>{var t,n,o;if((t=e.dataRef.current)!=null&&t.virtual)return{...e,options:[...e.options,s.payload]};let a=s.payload,i=Ee(e,h=>(h.push(a),h));e.activeOptionIndex===null&&(n=e.dataRef.current)!=null&&n.isSelected(s.payload.dataRef.current.value)&&(i.activeOptionIndex=i.options.indexOf(a));let l={...e,...i,activationTrigger:2};return(o=e.dataRef.current)!=null&&o.__demoMode&&e.dataRef.current.value===void 0&&(l.activeOptionIndex=0),l},4:(e,s)=>{var t;if((t=e.dataRef.current)!=null&&t.virtual)return{...e,options:e.options.filter(o=>o.id!==s.id)};let n=Ee(e,o=>{let a=o.findIndex(i=>i.id===s.id);return a!==-1&&o.splice(a,1),o});return{...e,...n,activationTrigger:2}},5:(e,s)=>e.labelId===s.id?e:{...e,labelId:s.id},6:(e,s)=>e.activationTrigger===s.trigger?e:{...e,activationTrigger:s.trigger},7:(e,s)=>{var t;if(((t=e.virtual)==null?void 0:t.options)===s.options)return e;let n=e.activeOptionIndex;if(e.activeOptionIndex!==null){let o=s.options.indexOf(e.virtual.options[e.activeOptionIndex]);o!==-1?n=o:n=null}return{...e,activeOptionIndex:n,virtual:Object.assign({},e.virtual,{options:s.options})}}},Oe=c.createContext(null);Oe.displayName="ComboboxActionsContext";function ce(e){let s=c.useContext(Oe);if(s===null){let t=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,ce),t}return s}let rt=c.createContext(null);function Is(e){var s;let t=te("VirtualProvider"),[n,o]=c.useMemo(()=>{let h=t.optionsRef.current;if(!h)return[0,0];let d=window.getComputedStyle(h);return[parseFloat(d.paddingBlockStart||d.paddingTop),parseFloat(d.paddingBlockEnd||d.paddingBottom)]},[t.optionsRef.current]),a=gs({scrollPaddingStart:n,scrollPaddingEnd:o,count:t.virtual.options.length,estimateSize(){return 40},getScrollElement(){var h;return(h=t.optionsRef.current)!=null?h:null},overscan:12}),[i,l]=c.useState(0);return B(()=>{l(h=>h+1)},[(s=t.virtual)==null?void 0:s.options]),L.createElement(rt.Provider,{value:a},L.createElement("div",{style:{position:"relative",width:"100%",height:`${a.getTotalSize()}px`},ref:h=>{if(h){if(typeof process<"u"&&Cs.JEST_WORKER_ID!==void 0||t.activationTrigger===0)return;t.activeOptionIndex!==null&&t.virtual.options.length>t.activeOptionIndex&&a.scrollToIndex(t.activeOptionIndex)}}},a.getVirtualItems().map(h=>{var d;return L.createElement(c.Fragment,{key:h.key},L.cloneElement((d=e.children)==null?void 0:d.call(e,{option:t.virtual.options[h.index],open:t.comboboxState===0}),{key:`${i}-${h.key}`,"data-index":h.index,"aria-setsize":t.virtual.options.length,"aria-posinset":h.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${h.start}px)`,overflowAnchor:"none"}}))})))}let _e=c.createContext(null);_e.displayName="ComboboxDataContext";function te(e){let s=c.useContext(_e);if(s===null){let t=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,te),t}return s}function Os(e,s){return se(s.type,Ts,e,s)}let _s=c.Fragment;function Ms(e,s){let{value:t,defaultValue:n,onChange:o,form:a,name:i,by:l=null,disabled:h=!1,__demoMode:d=!1,nullable:f=!1,multiple:g=!1,immediate:b=!1,virtual:u=null,...p}=e,v=!1,y=null,[x=g?[]:void 0,j]=et(t,o,n),[T,M]=c.useReducer(Os,{dataRef:c.createRef(),comboboxState:d?0:1,options:[],virtual:null,activeOptionIndex:null,activationTrigger:2,labelId:null}),F=c.useRef(!1),C=c.useRef({static:!1,hold:!1}),A=c.useRef(null),W=c.useRef(null),R=c.useRef(null),O=c.useRef(null),_=E(typeof l=="string"?(w,I)=>{let U=l;return(w==null?void 0:w[U])===(I==null?void 0:I[U])}:l??((w,I)=>w===I)),G=E(w=>T.options.findIndex(I=>_(I.dataRef.current.value,w))),ve=c.useCallback(w=>se(m.mode,{1:()=>x.some(I=>_(I,w)),0:()=>_(x,w)}),[x]),ye=E(w=>T.activeOptionIndex===G(w)),m=c.useMemo(()=>({...T,immediate:v,optionsPropsRef:C,labelRef:A,inputRef:W,buttonRef:R,optionsRef:O,value:x,defaultValue:n,disabled:h,mode:g?1:0,virtual:T.virtual,get activeOptionIndex(){if(F.current&&T.activeOptionIndex===null&&T.options.length>0){let w=T.options.findIndex(I=>!I.dataRef.current.disabled);if(w!==-1)return w}return T.activeOptionIndex},calculateIndex:G,compare:_,isSelected:ve,isActive:ye,nullable:f,__demoMode:d}),[x,n,h,g,f,d,T,y]);B(()=>{},[y,void 0]),B(()=>{T.dataRef.current=m},[m]),Ht([m.buttonRef,m.inputRef,m.optionsRef],()=>Se.closeCombobox(),m.comboboxState===0);let D=c.useMemo(()=>{var w,I,U;return{open:m.comboboxState===0,disabled:h,activeIndex:m.activeOptionIndex,activeOption:m.activeOptionIndex===null?null:m.virtual?m.virtual.options[(w=m.activeOptionIndex)!=null?w:0]:(U=(I=m.options[m.activeOptionIndex])==null?void 0:I.dataRef.current.value)!=null?U:null,value:x}},[m,h,x]),P=E(()=>{if(m.activeOptionIndex!==null){if(m.virtual)Ce(m.virtual.options[m.activeOptionIndex]);else{let{dataRef:w}=m.options[m.activeOptionIndex];Ce(w.current.value)}Se.goToOption(k.Specific,m.activeOptionIndex)}}),K=E(()=>{M({type:0}),F.current=!0}),N=E(()=>{M({type:1}),F.current=!1}),H=E((w,I,U)=>(F.current=!1,w===k.Specific?M({type:2,focus:k.Specific,idx:I,trigger:U}):M({type:2,focus:w,trigger:U}))),Q=E((w,I)=>(M({type:3,payload:{id:w,dataRef:I}}),()=>{m.isActive(I.current.value)&&(F.current=!0),M({type:4,id:w})})),Et=E(w=>(M({type:5,id:w}),()=>M({type:5,id:null}))),Ce=E(w=>se(m.mode,{0(){return j==null?void 0:j(w)},1(){let I=m.value.slice(),U=I.findIndex(he=>_(he,w));return U===-1?I.push(w):I.splice(U,1),j==null?void 0:j(I)}})),jt=E(w=>{M({type:6,trigger:w})}),Se=c.useMemo(()=>({onChange:Ce,registerOption:Q,registerLabel:Et,goToOption:H,closeCombobox:N,openCombobox:K,setActivationTrigger:jt,selectActiveOption:P}),[]),Tt=s===null?{}:{ref:s},de=c.useRef(null),It=me();return c.useEffect(()=>{de.current&&n!==void 0&&It.addEventListener(de.current,"reset",()=>{j==null||j(n)})},[de,j]),L.createElement(Oe.Provider,{value:Se},L.createElement(_e.Provider,{value:m},L.createElement(Mt,{value:se(m.comboboxState,{0:pe.Open,1:pe.Closed})},i!=null&&x!=null&&st({[i]:x}).map(([w,I],U)=>L.createElement(qe,{features:Ye.Hidden,ref:U===0?he=>{var Ne;de.current=(Ne=he==null?void 0:he.closest("form"))!=null?Ne:null}:void 0,...He({key:w,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:a,disabled:h,name:w,value:I})})),Y({ourProps:Tt,theirProps:p,slot:D,defaultTag:_s,name:"Combobox"}))))}let Rs="input";function Ns(e,s){var t,n,o,a,i;let l=ee(),{id:h=`headlessui-combobox-input-${l}`,onChange:d,displayValue:f,type:g="text",...b}=e,u=te("Combobox.Input"),p=ce("Combobox.Input"),v=Z(u.inputRef,s),y=Vt(u.inputRef),x=c.useRef(!1),j=me(),T=E(()=>{p.onChange(null),u.optionsRef.current&&(u.optionsRef.current.scrollTop=0),p.goToOption(k.Nothing)}),M=function(){var m;return typeof f=="function"&&u.value!==void 0?(m=f(u.value))!=null?m:"":typeof u.value=="string"?u.value:""}();Ae(([m,D],[P,K])=>{if(x.current)return;let N=u.inputRef.current;N&&((K===0&&D===1||m!==P)&&(N.value=m),requestAnimationFrame(()=>{if(x.current||!N||(y==null?void 0:y.activeElement)!==N)return;let{selectionStart:H,selectionEnd:Q}=N;Math.abs((Q??0)-(H??0))===0&&H===0&&N.setSelectionRange(N.value.length,N.value.length)}))},[M,u.comboboxState,y]),Ae(([m],[D])=>{if(m===0&&D===1){if(x.current)return;let P=u.inputRef.current;if(!P)return;let K=P.value,{selectionStart:N,selectionEnd:H,selectionDirection:Q}=P;P.value="",P.value=K,Q!==null?P.setSelectionRange(N,H,Q):P.setSelectionRange(N,H)}},[u.comboboxState]);let F=c.useRef(!1),C=E(()=>{F.current=!0}),A=E(()=>{j.nextFrame(()=>{F.current=!1})}),W=E(m=>{switch(x.current=!0,m.key){case $.Enter:if(x.current=!1,u.comboboxState!==0||F.current)return;if(m.preventDefault(),m.stopPropagation(),u.activeOptionIndex===null){p.closeCombobox();return}p.selectActiveOption(),u.mode===0&&p.closeCombobox();break;case $.ArrowDown:return x.current=!1,m.preventDefault(),m.stopPropagation(),se(u.comboboxState,{0:()=>p.goToOption(k.Next),1:()=>p.openCombobox()});case $.ArrowUp:return x.current=!1,m.preventDefault(),m.stopPropagation(),se(u.comboboxState,{0:()=>p.goToOption(k.Previous),1:()=>{p.openCombobox(),j.nextFrame(()=>{u.value||p.goToOption(k.Last)})}});case $.Home:if(m.shiftKey)break;return x.current=!1,m.preventDefault(),m.stopPropagation(),p.goToOption(k.First);case $.PageUp:return x.current=!1,m.preventDefault(),m.stopPropagation(),p.goToOption(k.First);case $.End:if(m.shiftKey)break;return x.current=!1,m.preventDefault(),m.stopPropagation(),p.goToOption(k.Last);case $.PageDown:return x.current=!1,m.preventDefault(),m.stopPropagation(),p.goToOption(k.Last);case $.Escape:return x.current=!1,u.comboboxState!==0?void 0:(m.preventDefault(),u.optionsRef.current&&!u.optionsPropsRef.current.static&&m.stopPropagation(),u.nullable&&u.mode===0&&u.value===null&&T(),p.closeCombobox());case $.Tab:if(x.current=!1,u.comboboxState!==0)return;u.mode===0&&u.activationTrigger!==1&&p.selectActiveOption(),p.closeCombobox();break}}),R=E(m=>{d==null||d(m),u.nullable&&u.mode===0&&m.target.value===""&&T(),p.openCombobox()}),O=E(m=>{var D,P,K;let N=(D=m.relatedTarget)!=null?D:Pe.find(H=>H!==m.currentTarget);if(x.current=!1,!((P=u.optionsRef.current)!=null&&P.contains(N))&&!((K=u.buttonRef.current)!=null&&K.contains(N))&&u.comboboxState===0)return m.preventDefault(),u.mode===0&&(u.nullable&&u.value===null?T():u.activationTrigger!==1&&p.selectActiveOption()),p.closeCombobox()}),_=E(m=>{var D,P,K;let N=(D=m.relatedTarget)!=null?D:Pe.find(H=>H!==m.currentTarget);(P=u.buttonRef.current)!=null&&P.contains(N)||(K=u.optionsRef.current)!=null&&K.contains(N)||u.disabled||u.immediate&&u.comboboxState!==0&&(p.openCombobox(),j.nextFrame(()=>{p.setActivationTrigger(1)}))}),G=Ie(()=>{if(u.labelId)return[u.labelId].join(" ")},[u.labelId]),ve=c.useMemo(()=>({open:u.comboboxState===0,disabled:u.disabled}),[u]),ye={ref:v,id:h,role:"combobox",type:g,"aria-controls":(t=u.optionsRef.current)==null?void 0:t.id,"aria-expanded":u.comboboxState===0,"aria-activedescendant":u.activeOptionIndex===null?void 0:u.virtual?(n=u.options.find(m=>{var D;return!((D=u.virtual)!=null&&D.disabled(m.dataRef.current.value))&&u.compare(m.dataRef.current.value,u.virtual.options[u.activeOptionIndex])}))==null?void 0:n.id:(o=u.options[u.activeOptionIndex])==null?void 0:o.id,"aria-labelledby":G,"aria-autocomplete":"list",defaultValue:(i=(a=e.defaultValue)!=null?a:u.defaultValue!==void 0?f==null?void 0:f(u.defaultValue):null)!=null?i:u.defaultValue,disabled:u.disabled,onCompositionStart:C,onCompositionEnd:A,onKeyDown:W,onChange:R,onFocus:_,onBlur:O};return Y({ourProps:ye,theirProps:b,slot:ve,defaultTag:Rs,name:"Combobox.Input"})}let ks="button";function Fs(e,s){var t;let n=te("Combobox.Button"),o=ce("Combobox.Button"),a=Z(n.buttonRef,s),i=ee(),{id:l=`headlessui-combobox-button-${i}`,...h}=e,d=me(),f=E(v=>{switch(v.key){case $.ArrowDown:return v.preventDefault(),v.stopPropagation(),n.comboboxState===1&&o.openCombobox(),d.nextFrame(()=>{var y;return(y=n.inputRef.current)==null?void 0:y.focus({preventScroll:!0})});case $.ArrowUp:return v.preventDefault(),v.stopPropagation(),n.comboboxState===1&&(o.openCombobox(),d.nextFrame(()=>{n.value||o.goToOption(k.Last)})),d.nextFrame(()=>{var y;return(y=n.inputRef.current)==null?void 0:y.focus({preventScroll:!0})});case $.Escape:return n.comboboxState!==0?void 0:(v.preventDefault(),n.optionsRef.current&&!n.optionsPropsRef.current.static&&v.stopPropagation(),o.closeCombobox(),d.nextFrame(()=>{var y;return(y=n.inputRef.current)==null?void 0:y.focus({preventScroll:!0})}));default:return}}),g=E(v=>{if(We(v.currentTarget))return v.preventDefault();n.comboboxState===0?o.closeCombobox():(v.preventDefault(),o.openCombobox()),d.nextFrame(()=>{var y;return(y=n.inputRef.current)==null?void 0:y.focus({preventScroll:!0})})}),b=Ie(()=>{if(n.labelId)return[n.labelId,l].join(" ")},[n.labelId,l]),u=c.useMemo(()=>({open:n.comboboxState===0,disabled:n.disabled,value:n.value}),[n]),p={ref:a,id:l,type:tt(e,n.buttonRef),tabIndex:-1,"aria-haspopup":"listbox","aria-controls":(t=n.optionsRef.current)==null?void 0:t.id,"aria-expanded":n.comboboxState===0,"aria-labelledby":b,disabled:n.disabled,onClick:g,onKeyDown:f};return Y({ourProps:p,theirProps:h,slot:u,defaultTag:ks,name:"Combobox.Button"})}let As="label";function Ps(e,s){let t=ee(),{id:n=`headlessui-combobox-label-${t}`,...o}=e,a=te("Combobox.Label"),i=ce("Combobox.Label"),l=Z(a.labelRef,s);B(()=>i.registerLabel(n),[n]);let h=E(()=>{var f;return(f=a.inputRef.current)==null?void 0:f.focus({preventScroll:!0})}),d=c.useMemo(()=>({open:a.comboboxState===0,disabled:a.disabled}),[a]);return Y({ourProps:{ref:l,id:n,onClick:h},theirProps:o,slot:d,defaultTag:As,name:"Combobox.Label"})}let Ls="ul",Ds=ke.RenderStrategy|ke.Static;function $s(e,s){let t=ee(),{id:n=`headlessui-combobox-options-${t}`,hold:o=!1,...a}=e,i=te("Combobox.Options"),l=Z(i.optionsRef,s),h=Rt(),d=h!==null?(h&pe.Open)===pe.Open:i.comboboxState===0;B(()=>{var u;i.optionsPropsRef.current.static=(u=e.static)!=null?u:!1},[i.optionsPropsRef,e.static]),B(()=>{i.optionsPropsRef.current.hold=o},[i.optionsPropsRef,o]),bs({container:i.optionsRef.current,enabled:i.comboboxState===0,accept(u){return u.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:u.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(u){u.setAttribute("role","none")}});let f=Ie(()=>{var u,p;return(p=i.labelId)!=null?p:(u=i.buttonRef.current)==null?void 0:u.id},[i.labelId,i.buttonRef.current]),g=c.useMemo(()=>({open:i.comboboxState===0,option:void 0}),[i]),b={"aria-labelledby":f,role:"listbox","aria-multiselectable":i.mode===1?!0:void 0,id:n,ref:l};return i.virtual&&i.comboboxState===0&&Object.assign(a,{children:L.createElement(Is,null,a.children)}),Y({ourProps:b,theirProps:a,slot:g,defaultTag:Ls,features:Ds,visible:d,name:"Combobox.Options"})}let zs="li";function Bs(e,s){var t;let n=ee(),{id:o=`headlessui-combobox-option-${n}`,disabled:a=!1,value:i,order:l=null,...h}=e,d=te("Combobox.Option"),f=ce("Combobox.Option"),g=d.virtual?d.activeOptionIndex===d.calculateIndex(i):d.activeOptionIndex===null?!1:((t=d.options[d.activeOptionIndex])==null?void 0:t.id)===o,b=d.isSelected(i),u=c.useRef(null),p=Ge({disabled:a,value:i,domRef:u,order:l}),v=c.useContext(rt),y=Z(s,u,v?v.measureElement:null),x=E(()=>f.onChange(i));B(()=>f.registerOption(o,p),[p,o]);let j=c.useRef(!(d.virtual||d.__demoMode));B(()=>{if(!d.virtual||!d.__demoMode)return;let O=Fe();return O.requestAnimationFrame(()=>{j.current=!0}),O.dispose},[d.virtual,d.__demoMode]),B(()=>{if(!j.current||d.comboboxState!==0||!g||d.activationTrigger===0)return;let O=Fe();return O.requestAnimationFrame(()=>{var _,G;(G=(_=u.current)==null?void 0:_.scrollIntoView)==null||G.call(_,{block:"nearest"})}),O.dispose},[u,g,d.comboboxState,d.activationTrigger,d.activeOptionIndex]);let T=E(O=>{var _;if(a||(_=d.virtual)!=null&&_.disabled(i))return O.preventDefault();x(),Kt()||requestAnimationFrame(()=>{var G;return(G=d.inputRef.current)==null?void 0:G.focus({preventScroll:!0})}),d.mode===0&&requestAnimationFrame(()=>f.closeCombobox())}),M=E(()=>{var O;if(a||(O=d.virtual)!=null&&O.disabled(i))return f.goToOption(k.Nothing);let _=d.calculateIndex(i);f.goToOption(k.Specific,_)}),F=xs(),C=E(O=>F.update(O)),A=E(O=>{var _;if(!F.wasMoved(O)||a||(_=d.virtual)!=null&&_.disabled(i)||g)return;let G=d.calculateIndex(i);f.goToOption(k.Specific,G,0)}),W=E(O=>{var _;F.wasMoved(O)&&(a||(_=d.virtual)!=null&&_.disabled(i)||g&&(d.optionsPropsRef.current.hold||f.goToOption(k.Nothing)))}),R=c.useMemo(()=>({active:g,selected:b,disabled:a}),[g,b,a]);return Y({ourProps:{id:o,ref:y,role:"option",tabIndex:a===!0?void 0:-1,"aria-disabled":a===!0?!0:void 0,"aria-selected":b,disabled:void 0,onClick:T,onFocus:M,onPointerEnter:C,onMouseEnter:C,onPointerMove:A,onMouseMove:A,onPointerLeave:W,onMouseLeave:W},theirProps:h,slot:R,defaultTag:zs,name:"Combobox.Option"})}let Us=J(Ms),Gs=J(Fs),Hs=J(Ns),Vs=J(Ps),Ks=J($s),qs=J(Bs),re=Object.assign(Us,{Input:Hs,Button:Gs,Label:Vs,Options:Ks,Option:qs}),at=c.createContext(null);function it(){let e=c.useContext(at);if(e===null){let s=new Error("You used a <Label /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(s,it),s}return e}function Ys(){let[e,s]=c.useState([]);return[e.length>0?e.join(" "):void 0,c.useMemo(()=>function(t){let n=E(a=>(s(i=>[...i,a]),()=>s(i=>{let l=i.slice(),h=l.indexOf(a);return h!==-1&&l.splice(h,1),l}))),o=c.useMemo(()=>({register:n,slot:t.slot,name:t.name,props:t.props}),[n,t.slot,t.name,t.props]);return L.createElement(at.Provider,{value:o},t.children)},[s])]}let Ws="label";function Xs(e,s){let t=ee(),{id:n=`headlessui-label-${t}`,passive:o=!1,...a}=e,i=it(),l=Z(s);B(()=>i.register(n),[n,i.register]);let h={ref:l,...i.props,id:n};return o&&("onClick"in h&&(delete h.htmlFor,delete h.onClick),"onClick"in a&&delete a.onClick),Y({ourProps:h,theirProps:a,slot:i.slot||{},defaultTag:Ws,name:i.name||"Label"})}let Js=J(Xs),Qs=Object.assign(Js,{}),Me=c.createContext(null);Me.displayName="GroupContext";let Zs=c.Fragment;function en(e){var s;let[t,n]=c.useState(null),[o,a]=Ys(),[i,l]=Wt(),h=c.useMemo(()=>({switch:t,setSwitch:n,labelledby:o,describedby:i}),[t,n,o,i]),d={},f=e;return L.createElement(l,{name:"Switch.Description"},L.createElement(a,{name:"Switch.Label",props:{htmlFor:(s=h.switch)==null?void 0:s.id,onClick(g){t&&(g.currentTarget.tagName==="LABEL"&&g.preventDefault(),t.click(),t.focus({preventScroll:!0}))}}},L.createElement(Me.Provider,{value:h},Y({ourProps:d,theirProps:f,defaultTag:Zs,name:"Switch.Group"}))))}let tn="button";function sn(e,s){var t;let n=ee(),{id:o=`headlessui-switch-${n}`,checked:a,defaultChecked:i=!1,onChange:l,disabled:h=!1,name:d,value:f,form:g,...b}=e,u=c.useContext(Me),p=c.useRef(null),v=Z(p,s,u===null?null:u.setSwitch),[y,x]=et(a,l,i),j=E(()=>x==null?void 0:x(!y)),T=E(R=>{if(We(R.currentTarget))return R.preventDefault();R.preventDefault(),j()}),M=E(R=>{R.key===$.Space?(R.preventDefault(),j()):R.key===$.Enter&&ys(R.currentTarget)}),F=E(R=>R.preventDefault()),C=c.useMemo(()=>({checked:y}),[y]),A={id:o,ref:v,role:"switch",type:tt(e,p),tabIndex:e.tabIndex===-1?0:(t=e.tabIndex)!=null?t:0,"aria-checked":y,"aria-labelledby":u==null?void 0:u.labelledby,"aria-describedby":u==null?void 0:u.describedby,disabled:h,onClick:T,onKeyUp:M,onKeyPress:F},W=me();return c.useEffect(()=>{var R;let O=(R=p.current)==null?void 0:R.closest("form");O&&i!==void 0&&W.addEventListener(O,"reset",()=>{x(i)})},[p,x]),L.createElement(L.Fragment,null,d!=null&&y&&L.createElement(qe,{features:Ye.Hidden,...He({as:"input",type:"checkbox",hidden:!0,readOnly:!0,disabled:h,form:g,checked:y,name:d,value:f})}),Y({ourProps:A,theirProps:b,slot:C,defaultTag:tn,name:"Switch"}))}let nn=J(sn),on=en,rn=Object.assign(nn,{Group:on,Label:Qs,Description:Yt});const S=({className:e,children:s})=>r.jsx("div",{className:z("flex flex-col gap-4 p-4 text-foreground",e),children:s}),an=({title:e,onClose:s})=>r.jsxs("div",{className:"flex items-center",children:[r.jsx("h2",{className:"text-lg font-medium",children:e}),r.jsx("button",{className:"btn btn-secondary btn-close ml-auto",onClick:s,children:r.jsx(je,{})})]}),ln=({className:e,as:s="div",children:t})=>s===c.Fragment?r.jsx(c.Fragment,{children:t}):r.jsx(s,{className:e,children:t}),cn=({className:e,children:s})=>r.jsx("div",{className:e,children:s});S.Header=an;S.Body=ln;S.Footer=cn;const lt=c.forwardRef(function({type:s="text",className:t="",isFocused:n=!1,...o},a){const i=c.useRef(null);return c.useImperativeHandle(a,()=>({focus:()=>{var l;return(l=i.current)==null?void 0:l.focus()}})),c.useEffect(()=>{var l;n&&((l=i.current)==null||l.focus())},[]),r.jsx("textarea",{...o,className:"form-control "+t,ref:i})}),un=(e,s)=>{const[t,n]=c.useState(e);return c.useEffect(()=>{const o=setTimeout(()=>{n(e)},s);return()=>{clearTimeout(o)}},[e,s]),[t]};function ct({url:e,onChange:s,initialSelected:t,refId:n,disabled:o}){const[a,i]=c.useState([]),[l,h]=c.useState(""),[d]=un(l,300),[f,g]=c.useState(t);c.useEffect(()=>{if(l.length===0)return i([]);window.axios.get(`${e}?query=${l}`).then(v=>{i(v.data.data.filter(y=>f.find(x=>x.id===y.id)===void 0))})},[d]);const b=l===""?a:a.filter(v=>v.name.toLowerCase().includes(l.toLowerCase())),u=v=>{s(v.map(y=>y.id)),g(v)},p=v=>{const y=f.filter(x=>x.id!==v.id);g(y),s(y.map(x=>x.id))};return r.jsxs(re,{value:f,onChange:u,multiple:!0,children:[r.jsxs("div",{className:"form-control combobox relative h-full w-full cursor-default overflow-hidden","aria-disabled":o,tabIndex:-1,children:[f.length>0&&r.jsx("ul",{className:"m-2 flex flex-wrap gap-1 text-xs",children:f.map(v=>r.jsxs("li",{className:"flex items-center justify-between gap-2 rounded-full bg-primary px-2 py-1 text-white",children:[r.jsx("span",{children:v.name}),!o&&r.jsx("button",{className:"flex h-3 w-3 items-center rounded-full bg-white text-sm text-black",type:"button",onClick:()=>p(v),tabIndex:-1,children:r.jsx(je,{})})]},v.id))}),r.jsx(re.Input,{onChange:v=>h(v.target.value),displayValue:v=>v.name,className:z("w-full border-none py-2 pl-3 pr-10 leading-5 text-foreground outline-none focus:ring-0",o?"bg-transparent":"bg-background"),id:n,tabIndex:0,"aria-disabled":o}),r.jsx(re.Button,{className:"absolute inset-y-0 right-0 flex items-center pr-2",children:r.jsx(Nt,{className:"h-5 w-5 text-gray-400"})})]}),r.jsx(Ve,{as:c.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",afterLeave:()=>h(""),children:r.jsx(re.Options,{className:z("absolute mt-1 max-h-60 w-full overflow-auto rounded-md border-gray-200 bg-background text-base shadow-lg focus:outline-none dark:border-gray-500/25 sm:text-sm",(l.length>0||b.length>0)&&"border"),children:b.length===0&&l.length>0?r.jsx("div",{className:"relative cursor-default select-none px-4 py-2 text-foreground",children:"Nothing found."}):b.map(v=>r.jsx(re.Option,{value:v,className:({active:y})=>z("relative cursor-default select-none px-4 py-2",y?"bg-secondary":"text-foreground"),children:({selected:y})=>r.jsxs(r.Fragment,{children:[r.jsx("span",{className:z("block truncate",y?"font-medium":"font-normal"),children:v.name}),y&&r.jsx("span",{className:"absolute inset-y-0 right-2 flex items-center pl-3 text-foreground",children:r.jsx(kt,{className:"h-5 w-5"})})]})},v.id))})})]})}function dn(){const{closeModal:e}=q(),s=c.useRef(null),{data:t,setData:n,post:o,errors:a,processing:i}=Ue({_method:"POST",name:"",description:"",avatar:null,group_members:[]}),l=f=>{f.preventDefault(),!i&&o(route("group.store"),{onSuccess:g=>{const b=g.props;fe.get(route("chats.show",b.user.id)),e()}})},h=f=>{var b;const g=f.target.files;if(g&&g.length>0){n("avatar",g[0]);const u=window.URL.createObjectURL(g[0]);return(b=s.current)==null||b.setAttribute("src",u),()=>{window.URL.revokeObjectURL(u)}}},d=f=>{n("group_members",f)};return r.jsx("form",{onSubmit:l,className:"space-y-4",children:r.jsxs(S,{children:[r.jsx(S.Header,{title:"New Group",onClose:e}),r.jsxs(S.Body,{as:c.Fragment,children:[r.jsxs("div",{className:"picture relative",children:[r.jsx("img",{src:"/images/group-avatar.png",alt:"group-avatar.png",className:"mx-auto h-20 w-20 rounded-full border border-secondary",ref:s}),r.jsxs("label",{htmlFor:"avatar",className:"btn btn-primary absolute left-1/2 top-6 flex translate-x-5 cursor-pointer items-center justify-center rounded-full px-2",tabIndex:0,children:[r.jsx(Ke,{}),r.jsx("input",{type:"file",onChange:h,id:"avatar",className:"hidden"})]}),r.jsx(X,{className:"mt-2 text-center",message:a.avatar})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(ne,{htmlFor:"name",value:"Subject"}),r.jsx(Xe,{id:"name",type:"text",className:"mt-1 block w-full",value:t.name,onChange:f=>n("name",f.target.value)}),r.jsx(X,{className:"mt-2",message:a.name})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(ne,{htmlFor:"description",value:"Description"}),r.jsx(lt,{id:"description",className:"mt-1 block w-full",value:t.description,onChange:f=>n("description",f.target.value)}),r.jsx(X,{className:"mt-2",message:a.description})]}),r.jsxs("div",{className:"relative space-y-2",children:[r.jsx(ne,{htmlFor:"group_members",value:"Add members"}),r.jsx(ct,{url:route("users.index"),onChange:d,initialSelected:[],refId:"group_members"}),r.jsx(X,{className:"mt-2",message:a.group_members})]})]}),r.jsxs(S.Footer,{className:"flex justify-between gap-4",children:[r.jsx("button",{className:"btn btn-secondary flex-1",onClick:e,children:"Cancel"}),r.jsx("button",{className:"btn btn-primary flex-1",disabled:i,children:"Save"})]})]})})}const no=e=>window.axios.get(`${route("contacts.data")}?query=${e||""}`),oo=e=>window.axios.get(e),ro=e=>window.axios.post(route("contacts.save",e)),hn=e=>window.axios.post(route("contacts.block",e)),ao=e=>window.axios.post(route("contacts.unblock",e)),fn=e=>window.axios.delete(route("contacts.destroy",e)),io=({user:e,message:s,attachments:t})=>window.axios.post(route("chats.store"),{to_id:e.id,body:s,attachments:t},{headers:{"Content-Type":"multipart/form-data"}}),pn=e=>window.axios.delete(route("chats.destroy",e.id)),lo=(e,s)=>window.axios.delete(route("chats.delete_file",[e.id,s.file_name])),mn=e=>window.axios.get(route("chats.messages",e.id)),co=e=>window.axios.get(e),gn=e=>window.axios.get(route("chats.media",e.id)),xn=e=>window.axios.get(route("chats.files",e.id)),bn=e=>window.axios.get(route("chats.links",e.id));var ut=(e=>(e.CHATS="chats",e.GROUP_CHATS="group_chats",e))(ut||{});const uo=e=>(e=ie(e).startOf("second").fromNow(),e.replace(/(\d+)\s*(minute?|hour?|day?|week?|month?|year?)s?/,(s,t,n)=>{switch(n){case"minute":return t+"m";case"hour":return t+"h";case"day":return t+"d";case"week":return t+"w";case"month":return t+"M";case"year":return t+"y";default:return s}}).replace(" ago","")),dt=e=>{var n;if(!e)return!1;const s=["jpg","jpeg","png","gif","svg","bmp","webp"],t=((n=e.split(".").pop())==null?void 0:n.toLowerCase())??"";return s.includes(t)},ho=e=>e<1024?e.toFixed(2)+" B":e<1024*1024?(e/1024).toFixed(2)+" KB":e<1024*1024*1024?(e/(1024*1024)).toFixed(2)+" MB":(e/(1024*1024*1024)).toFixed(2)+" GB",ht=e=>e.some(s=>dt(s.original_name)),ft=e=>e.some(s=>!dt(s.original_name)),pt=e=>e&&e.length>0,vn=e=>{const s=document.title,t=/\(\d+\)/;if(t.test(s)){let n=s.replace(t,`(${e})`);e===0&&(n=n.replace("(0) ","")),document.title=n}else if(e>0){const n=`(${e}) ${s}`;document.title=n}},mt={user:{id:"",name:"",email:"",email_verified_at:"",avatar:"",active_status:!1,is_online:!1,last_seen:"",chat_type:ut.CHATS,message_color:"",is_contact_saved:!1,is_contact_blocked:!1,description:"",creator_id:"",creator:{id:"",name:""},members_count:0},messages:[],paginate:Te,media:[],selectedMedia:void 0,files:[],links:[],showSidebarRight:!1,isTyping:!1,setUser:()=>{},setMessages:()=>{},setPaginate:()=>{},setMedia:()=>{},setSelectedMedia:()=>{},clearSelectedMedia:()=>{},setFiles:()=>{},setLinks:()=>{},reloadMedia:()=>{},reloadFiles:()=>{},reloadLinks:()=>{},toggleSidebarRight:()=>{},setIsTyping:()=>{}},yn=(e,s)=>{switch(s.type){case"SET_USER":return{...e,user:s.payload};case"TOGGLE_SIDEBAR_RIGHT":const t=localStorage.getItem("toggle-sidebar-right")==="true";return localStorage.setItem("toggle-sidebar-right",String(!t)),{...e,showSidebarRight:!t};case"SET_MESSAGES":return{...e,messages:s.payload};case"SET_PAGINATE":return{...e,paginate:s.payload};case"SET_MEDIA":return{...e,media:s.payload};case"SET_SELECTED_MEDIA":return{...e,selectedMedia:s.payload};case"SET_FILES":return{...e,files:s.payload};case"SET_LINKS":return{...e,links:s.payload};case"SET_IS_TYPING":return{...e,isTyping:s.payload}}},gt=c.createContext(mt),Re=()=>c.useContext(gt),fo=({children:e})=>{const s=le().props,[t,n]=c.useReducer(yn,mt),[o,a]=c.useState(!0),i=C=>n({type:"SET_USER",payload:C}),l=C=>n({type:"SET_MESSAGES",payload:C}),h=C=>n({type:"SET_PAGINATE",payload:C}),d=C=>n({type:"SET_MEDIA",payload:C}),f=C=>n({type:"SET_SELECTED_MEDIA",payload:C}),g=()=>n({type:"SET_SELECTED_MEDIA",payload:void 0}),b=C=>n({type:"SET_FILES",payload:C}),u=C=>n({type:"SET_LINKS",payload:C}),p=C=>{gn(C).then(A=>d(A.data.data))},v=C=>{xn(C).then(A=>b(A.data.data))},y=C=>{bn(C).then(A=>u(A.data.data))},x=()=>n({type:"TOGGLE_SIDEBAR_RIGHT"}),j=C=>n({type:"SET_IS_TYPING",payload:C}),T=()=>{mn(s.user).then(C=>{h(C.data.data),l(C.data.data.data)})},M=C=>{T(),ht(C.chat.attachments)&&p(s.user),ft(C.chat.attachments)&&v(s.user),pt(C.chat.links)&&y(s.user)};c.useEffect(()=>{a(!1),i(s.user),l(s.messages.data),h(s.messages),d(s.media),b(s.files),u(s.links),window.Echo.channel("user-activity").listen(".user-activity",C=>{const A=t.user.id?t.user:s.user;A.id===C.user.id&&i({...A,is_online:C.user.is_online})}),window.Echo.channel(`send-message-${s.user.id}-to-${s.auth.id}`).listen(".send-message",M),window.Echo.channel(`send-group-message-${s.user.id}`).listen(".send-group-message",M)},[]);const F={...t,user:o?s.user:t.user,messages:o?s.messages.data:t.messages,paginate:o?s.messages:t.paginate,media:o?s.media:t.media,files:o?s.files:t.files,links:o?s.links:t.links,showSidebarRight:localStorage.getItem("toggle-sidebar-right")==="true",setUser:i,setMessages:l,setPaginate:h,setMedia:d,setSelectedMedia:f,clearSelectedMedia:g,setFiles:b,setLinks:u,reloadMedia:p,reloadFiles:v,reloadLinks:y,toggleSidebarRight:x,setIsTyping:j};return r.jsx(gt.Provider,{value:F,children:e})},xt={contacts:[],paginate:Te,setContacts:()=>{},setPaginate:()=>{}},Cn=(e,s)=>{switch(s.type){case"SET_CONTACTS":return{...e,contacts:s.payload};case"SET_PAGINATE":return{...e,paginate:s.payload}}},bt=c.createContext(xt),vt=()=>c.useContext(bt),po=({children:e})=>{const s=le().props,[t,n]=c.useReducer(Cn,xt),[o,a]=c.useState(!0),i=d=>n({type:"SET_CONTACTS",payload:d}),l=d=>n({type:"SET_PAGINATE",payload:d});c.useEffect(()=>{a(!1),i(s.contacts.data),l(s.contacts),window.Echo.channel("user-activity").listen(".user-activity",d=>{const f=t.contacts.length>0?t.contacts:s.contacts.data;if(Array.isArray(d.user)){const g=d.user;i(f.map(b=>{const u=g.find(p=>p.id===b.id);return u&&(b.is_online=u.is_online),b}))}else{const g=d.user;i(f.map(b=>(b.id===g.id&&(b.is_online=g.is_online),b)))}})},[]);const h={...t,contacts:o?s.contacts.data:t.contacts,paginate:o?s.contacts:t.paginate,setContacts:i,setPaginate:l};return r.jsx(bt.Provider,{value:h,children:e})};function Sn(){const{closeModal:e,data:s}=q(),{chats:t,setChats:n}=ge(),{contacts:o,setContacts:a}=vt(),{user:i,setUser:l}=Re();if(!s)return;const h=()=>{hn(s.id).then(()=>{route().current("chats.*")||route().current("archived_chats.*")?(n(t.map(d=>(d.id===s.id&&(d.is_contact_blocked=!0),d))),(i==null?void 0:i.id)===s.id&&l({...i,is_contact_blocked:!0})):a(o.map(d=>(d.id===s.id&&(d.is_contact_blocked=!0),d))),e()})};return r.jsxs(S,{children:[r.jsx(S.Header,{title:"Block Contact?",onClose:e}),r.jsx(S.Body,{as:c.Fragment,children:r.jsx("p",{children:"This contact will be removed from your contacts. You can save the contact once you open again the block."})}),r.jsxs(S.Footer,{className:"flex justify-between gap-4",children:[r.jsx("button",{className:"btn btn-secondary flex-1",onClick:e,children:"Cancel"}),r.jsx("button",{className:"btn btn-danger flex-1",onClick:h,children:"Block"})]})]})}function wn(){const{closeModal:e,dispatchOnCanceled:s}=q(),{user:t,setUser:n}=Re(),[o,a]=c.useState(null),i=["#2863EB","#2196F3","#00BCD4","#3F51B5","#673AB7","#9C27B0","#F25C55","#FFC107","#FF9800","#ff2522","#4CAF50","#ED9F9B"],l=f=>{a(f),n({...t,message_color:f})},h=()=>{ts(t,o).then(()=>{e()})},d=()=>{s&&typeof s=="function"&&s(),e()};return r.jsxs(S,{children:[r.jsx(S.Header,{title:"Themes",onClose:d}),r.jsx(S.Body,{className:"grid grid-cols-4 gap-2",children:i.map((f,g)=>r.jsx("button",{className:z("flex h-20 w-20 items-center justify-center rounded-2xl p-2 hover:bg-secondary focus:bg-secondary",f===o&&"bg-secondary"),onClick:()=>l(f),children:r.jsx("span",{className:"inline-block h-16 w-16 shrink-0 rounded-full",style:{background:f}})},g))}),r.jsxs(S.Footer,{className:"flex justify-between gap-4",children:[r.jsx("button",{className:"btn btn-secondary flex-1",onClick:d,children:"Cancel"}),r.jsx("button",{className:"btn btn-primary flex-1",onClick:h,children:"Save"})]})]})}function En(){const{closeModal:e,data:s}=q(),{chats:t,setChats:n}=ge();if(!s)return;const o=()=>{es(s).then(()=>{if(route().current("chats.index")||route().current("archived_chats.index")){e(),n([...t.filter(a=>a.id!==s.id)]);return}route().current("chats.*")?fe.replace(route("chats.index")):fe.replace(route("archived_chats.index"))})};return r.jsxs(S,{children:[r.jsx(S.Header,{title:"Delete Chat?",onClose:e}),r.jsx(S.Body,{as:c.Fragment,children:r.jsx("p",{children:"This chat will be removed for you, including the files. Others in the chat will still be able to see it."})}),r.jsxs(S.Footer,{className:"flex justify-between gap-4",children:[r.jsx("button",{className:"btn btn-secondary flex-1",onClick:e,children:"Cancel"}),r.jsx("button",{className:"btn btn-danger flex-1",onClick:o,children:"Delete for me"})]})]})}function jn(){const{closeModal:e,data:s}=q(),{contacts:t,setContacts:n}=vt();if(!s)return;const o=()=>{fn(s.id).then(()=>{e(),n([...t.filter(a=>a.id!==s.id)])})};return r.jsxs(S,{children:[r.jsx(S.Header,{title:"Delete Contact?",onClose:e}),r.jsx(S.Body,{as:c.Fragment,children:r.jsx("p",{children:"This contact will be removed for you. It will not appear in your contact list."})}),r.jsxs(S.Footer,{className:"flex justify-between gap-4",children:[r.jsx("button",{className:"btn btn-secondary flex-1",onClick:e,children:"Cancel"}),r.jsx("button",{className:"btn btn-danger flex-1",onClick:o,children:"Delete contact"})]})]})}function Tn(){var f;const{closeModal:e,data:s}=q(),{refetchChats:t}=ge(),{messages:n,setMessages:o,user:a,reloadMedia:i,reloadFiles:l,reloadLinks:h}=Re();if(!s)return;const d=()=>{pn(s).then(()=>{t(),o([...n.filter(g=>g.id!==s.id)]),ht(s.attachments)&&i(a),ft(s.attachments)&&l(a),pt(s.links)&&h(a),e()})};return r.jsxs(S,{children:[r.jsx(S.Header,{title:"Delete Message?",onClose:e}),r.jsxs(S.Body,{as:c.Fragment,children:[r.jsx("p",{children:"This message will be removed for you. Others in the chat will still be able to see it."}),((f=s.attachments)==null?void 0:f.length)>0&&r.jsxs("p",{children:[s.attachments.length," files will be removed for you."]})]}),r.jsxs(S.Footer,{className:"flex justify-between gap-4",children:[r.jsx("button",{className:"btn btn-secondary flex-1",onClick:e,children:"Cancel"}),r.jsx("button",{className:"btn btn-danger flex-1",onClick:d,children:"Delete for me"})]})]})}const In=e=>window.axios.get(route("group.members",e.id)),On=e=>window.axios.delete(route("group.exit",e.id));function Be({message:e,className:s}){const{setErrorMsg:t,setSuccessMsg:n}=xe(),o=()=>{t(null),n(null)};return r.jsx("div",{className:"fixed bottom-16 left-2 right-2 z-[60] sm:bottom-auto sm:top-2",children:r.jsxs("div",{className:z("flex items-center gap-2 rounded-lg p-4 text-sm sm:ml-auto sm:max-w-lg",s),children:[r.jsx("p",{children:e}),r.jsx("button",{className:"ml-auto text-xl opacity-70 transition-all hover:opacity-100",onClick:o,children:r.jsx(je,{})})]})})}const yt={theme:localStorage.getItem("theme")||"system",auth:{id:"",name:"",email:"",email_verified_at:"",avatar:"",active_status:!1,is_online:!1,last_seen:"",is_contact_blocked:!1,is_contact_saved:!1},notificationCount:0,setTheme:()=>{},setAuth:()=>{},setErrorMsg:()=>{},setSuccessMsg:()=>{},syncNotification:()=>{}},_n=(e,s)=>{switch(s.type){case"SET_THEME":const t=s.payload,n=document.documentElement;switch(n&&(n.classList.remove("dark"),n.classList.remove("light")),t){case"system":window.matchMedia("(prefers-color-scheme: dark)").matches?n.classList.add("dark"):n.classList.add("light");break;case"dark":n.classList.add("dark");break;case"light":n.classList.add("light")}return localStorage.setItem("theme",t),{...e,theme:t};case"SET_AUTH":return{...e,auth:s.payload};case"SET_ERROR_MSG":return{...e,errorMsg:s.payload};case"SET_SUCCESS_MSG":return{...e,successMsg:s.payload};case"SET_NOTIFICATION_COUNT":return{...e,notificationCount:s.payload}}},Ct=c.createContext(yt),xe=()=>c.useContext(Ct),Mn=({children:e})=>{const s=le().props,[t,n]=c.useReducer(_n,yt),[o,a]=c.useState(!0),i=c.useRef(null),l=p=>n({type:"SET_THEME",payload:p}),h=p=>n({type:"SET_AUTH",payload:p}),d=p=>n({type:"SET_ERROR_MSG",payload:p}),f=p=>n({type:"SET_SUCCESS_MSG",payload:p}),g=p=>n({type:"SET_NOTIFICATION_COUNT",payload:p}),b=async()=>{const p=localStorage.getItem("last-sync-notification"),v=ie();if(!(p&&v.diff(ie(parseInt(p)))<3e3))return localStorage.setItem("last-sync-notification",v.valueOf().toString()),await Zt().then(y=>{g(y.data.data.notification_count)})};c.useEffect(()=>{h(s.auth),g(s.notification_count),a(!1),s.error_msg&&d(s.error_msg),s.success_msg&&f(s.success_msg),window.Echo.channel(`send-message-${s.auth.id}`).listen(".send-message",()=>{b().then(()=>{var p;(p=i.current)==null||p.play()})})},[]),c.useEffect(()=>{t.errorMsg&&setTimeout(()=>d(null),5e3),t.successMsg&&setTimeout(()=>f(null),5e3)},[t.errorMsg,t.successMsg]),c.useEffect(()=>{!o&&vn(t.notificationCount)},[t.notificationCount]);const u={...t,theme:localStorage.getItem("theme")||"system",auth:o?s.auth:t.auth,notificationCount:o?s.notification_count:t.notificationCount,setTheme:l,setAuth:h,setErrorMsg:d,setSuccessMsg:f,syncNotification:b};return r.jsxs(Ct.Provider,{value:u,children:[e,t.errorMsg&&r.jsx(Be,{message:t.errorMsg,className:"bg-danger text-white"}),t.successMsg&&r.jsx(Be,{message:t.successMsg,className:"bg-success text-white"}),r.jsxs("audio",{controls:!0,className:"hidden",ref:i,children:[r.jsx("source",{src:"/audios/notification.mp3",type:"audio/mpeg"}),"Your browser does not support the audio element."]})]})};function Rn(){const{auth:e}=xe(),{closeModal:s,data:t}=q(),[n,o]=c.useState(!1),[a,i]=c.useState([]),l=c.useRef(null),{data:h,setData:d,post:f,errors:g,processing:b}=Ue({_method:"PATCH",name:t==null?void 0:t.name,description:t==null?void 0:t.description,avatar:null,group_members:[]});c.useEffect(()=>{In(t).then(x=>{const j=x.data.data.map(T=>({id:T.id,name:T.name}));i(j),o(!0),d("group_members",j.map(T=>T.id))})},[]);const u=e.id===(t==null?void 0:t.creator_id),p=x=>{x.preventDefault(),!(b||!u)&&f(route("group.update",t==null?void 0:t.id),{onSuccess:j=>{const T=j.props;fe.get(route("chats.show",T.user.id)),s()}})},v=x=>{var T;const j=x.target.files;if(j&&j.length>0){d("avatar",j[0]);const M=window.URL.createObjectURL(j[0]);return(T=l.current)==null||T.setAttribute("src",M),()=>{window.URL.revokeObjectURL(M)}}},y=x=>{d("group_members",x)};return r.jsx("form",{onSubmit:p,className:"space-y-4",children:r.jsxs(S,{children:[r.jsx(S.Header,{title:"Group Detail",onClose:s}),r.jsx(S.Body,{as:c.Fragment,children:n?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"picture relative",children:[r.jsx("img",{src:t==null?void 0:t.avatar,alt:t==null?void 0:t.name,className:"mx-auto h-20 w-20 rounded-full border border-secondary",ref:l}),u&&r.jsxs("label",{htmlFor:"avatar",className:"btn btn-primary absolute left-1/2 top-6 flex translate-x-5 cursor-pointer items-center justify-center rounded-full px-2",tabIndex:0,children:[r.jsx(Ke,{}),r.jsx("input",{type:"file",onChange:v,id:"avatar",className:"hidden"})]}),r.jsx(X,{className:"mt-2 text-center",message:g.avatar})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(ne,{htmlFor:"name",value:"Subject"}),r.jsx(Xe,{id:"name",type:"text",className:"mt-1 block w-full",value:h.name,onChange:x=>d("name",x.target.value),disabled:!u}),r.jsx(X,{className:"mt-2",message:g.name})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(ne,{htmlFor:"description",value:"Description"}),r.jsx(lt,{id:"description",className:"mt-1 block w-full",value:h.description,onChange:x=>d("description",x.target.value),disabled:!u}),r.jsx(X,{className:"mt-2",message:g.description})]}),r.jsxs("div",{className:"relative space-y-2",children:[r.jsx(ne,{htmlFor:"group_members",value:"Add members"}),r.jsx(ct,{url:route("users.index"),onChange:y,initialSelected:a,refId:"group_members",disabled:!u}),r.jsx(X,{className:"mt-2",message:g.group_members})]})]}):r.jsx("p",{className:"p-4",children:"Loading..."})}),u&&r.jsxs(S.Footer,{className:"flex justify-between gap-4",children:[r.jsx("button",{className:"btn btn-secondary flex-1",onClick:s,children:"Cancel"}),r.jsx("button",{className:"btn btn-primary flex-1",disabled:b,children:"Save"})]})]})})}function Nn(){const{closeModal:e,data:s}=q(),{chats:t,setChats:n}=ge(),o=()=>{On(s).then(()=>{n(t.filter(a=>a.id!==(s==null?void 0:s.id))),e()})};return r.jsxs(S,{children:[r.jsx(S.Header,{title:`Exit "${s==null?void 0:s.name}" group?`,onClose:e}),r.jsx(S.Body,{as:c.Fragment,children:r.jsx("p",{children:"This group will be removed for you. You can not see anything in this group."})}),r.jsxs(S.Footer,{className:"flex justify-between gap-4",children:[r.jsx("button",{className:"btn btn-secondary flex-1",onClick:e,children:"Cancel"}),r.jsx("button",{className:"btn btn-danger flex-1",onClick:o,children:"Exit group"})]})]})}const be=c.createContext({open:!1,setOpen:()=>{},toggleOpen:()=>{}}),mo=()=>c.useContext(be),ue=({children:e})=>{const[s,t]=c.useState(!1),n=()=>{t(o=>!o)};return r.jsx(be.Provider,{value:{open:s,setOpen:t,toggleOpen:n},children:r.jsx("div",{className:"relative",children:e})})},kn=({children:e})=>{const{open:s,setOpen:t,toggleOpen:n}=c.useContext(be);return r.jsxs(r.Fragment,{children:[r.jsx("div",{onClick:n,children:e}),s&&r.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>t(!1)})]})},Fn=({align:e="right",width:s="48",contentClasses:t="py-1 bg-background",children:n})=>{const{open:o,setOpen:a}=c.useContext(be);let i="origin-top";e==="left"?i="origin-top-left end-0 sm:start-0 mt-2":e==="right"?i="origin-top-right end-0 mt-2":e==="top-left"?i="origin-bottom-left bottom-0 end-0 sm:start-0 mb-2":e==="top-right"&&(i="origin-bottom-right bottom-0 end-0 mb-2");let l="";return s==="48"&&(l="w-48"),r.jsx(r.Fragment,{children:r.jsx(Ve,{as:c.Fragment,show:o,enter:"transition ease-out duration-200",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:r.jsx("div",{className:`absolute z-50 ${i} ${l}`,onClick:()=>a(!1),children:r.jsx("div",{className:"rounded-lg bg-background !p-2 shadow-md ring-1 ring-black ring-opacity-5 dark:ring-white dark:ring-opacity-5 "+t,children:n})})})})},An=({className:e="",children:s,...t})=>r.jsx(ae,{...t,className:"block w-full rounded-md px-4 py-2 text-start text-sm leading-5 text-foreground transition duration-150 ease-in-out hover:bg-secondary focus:bg-secondary focus:outline-none "+e,children:s}),Pn=({className:e="",children:s,...t})=>r.jsx("button",{...t,className:"block w-full rounded-md px-4 py-2 text-start text-sm leading-5 text-foreground transition duration-150 ease-in-out hover:bg-secondary focus:bg-secondary focus:outline-none "+e,children:s});ue.Trigger=kn;ue.Content=Fn;ue.Link=An;ue.Button=Pn;const V=ue,Ln=(e,s)=>window.axios.patch(route("users.update",e.id),{email:e.email,name:e.name,...s});function Dn(){const{theme:e,auth:s,setTheme:t,setAuth:n}=xe(),{closeModal:o}=q(),a=i=>{Ln(s,{active_status:i}).then(()=>{n({...s,active_status:i})})};return r.jsxs(S,{children:[r.jsx(S.Header,{title:"Preferences",onClose:o}),r.jsxs(S.Body,{className:"flex",as:c.Fragment,children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx(Ft,{}),"Theme"]}),r.jsxs(V,{children:[r.jsx(V.Trigger,{children:r.jsxs("button",{className:"btn btn-secondary flex items-center gap-2",children:[e.charAt(0).toUpperCase()+e.slice(1),r.jsx(At,{})]})}),r.jsxs(V.Content,{children:[r.jsx(V.Button,{onClick:()=>t("system"),children:"System"}),r.jsx(V.Button,{onClick:()=>t("dark"),children:"Dark"}),r.jsx(V.Button,{onClick:()=>t("light"),children:"Light"})]})]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx(Pt,{}),"Active Status"]}),r.jsxs(rn,{checked:s.active_status,onChange:a,className:z("relative inline-flex h-6 w-11 items-center rounded-full",s.active_status?"bg-primary":"bg-secondary"),children:[r.jsx("span",{className:"sr-only",children:"Enable active status"}),r.jsx("span",{className:`${s.active_status?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white transition`})]})]})]})]})}const St={isOpen:!1,openModal:()=>{},closeModal:()=>{}},$n=(e,s)=>{switch(s.type){case"OPEN":return{...e,view:s.view,size:s.size,data:s.payload,isOpen:!0,dispatchOnCanceled:s.payload&&s.payload.dispatchOnCanceled&&s.payload.dispatchOnCanceled};case"CLOSE":return{...e,view:void 0,size:void 0,data:void 0,isOpen:!1,dispatchOnCanceled:void 0}}},wt=c.createContext(St);function q(){return c.useContext(wt)}const go=({children:e})=>{const[s,t]=c.useReducer($n,St),a={...s,openModal:({view:i,size:l,payload:h})=>t({type:"OPEN",view:i,size:l,payload:h}),closeModal:()=>t({type:"CLOSE"})};return r.jsxs(wt.Provider,{value:a,children:[e,r.jsx(zn,{})]})},zn=()=>{const{isOpen:e,view:s,size:t,closeModal:n,dispatchOnCanceled:o}=q(),a=()=>{o&&typeof o=="function"&&o(),n()};return r.jsxs(Xt,{show:e,onClose:a,maxWidth:t,children:[s==="PREFERENCES"&&r.jsx(Dn,{}),s==="DELETE_MESSAGE_CONFIRMATION"&&r.jsx(Tn,{}),s==="DELETE_CHAT_CONFIRMATION"&&r.jsx(En,{}),s==="BLOCK_CONTACT_CONFIRMATION"&&r.jsx(Sn,{}),s==="CUSTOMIZE_CHAT"&&r.jsx(wn,{}),s==="ADD_NEW_GROUP"&&r.jsx(dn,{}),s==="EDIT_GROUP"&&r.jsx(Rn,{}),s==="EXIT_GROUP_CONFIRMATION"&&r.jsx(Nn,{}),s==="DELETE_CONTACT_CONFIRMATION"&&r.jsx(jn,{})]})};function xo({title:e,children:s}){const{notification_count:t}=le().props;return r.jsxs(Mn,{children:[r.jsx(_t,{title:z(t>0&&`(${t})`,e)}),r.jsx("div",{className:"flex h-screen flex-col overflow-hidden bg-background text-foreground sm:flex-row",children:s})]})}function Bn(){return r.jsx("span",{className:"absolute -mr-5 -mt-5 h-2.5 w-2.5 rounded-full bg-primary ring-2 ring-white sm:right-2.5 sm:top-2.5 sm:mr-0 sm:mt-0"})}const Un=()=>{const[e,s]=c.useState({width:window.innerWidth,height:window.innerHeight});return c.useEffect(()=>{const t=()=>{s({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},[]),e};function bo(){const{auth:e,notificationCount:s}=xe(),{openModal:t}=q(),{width:n}=Un(),o=()=>{t({view:"PREFERENCES",size:"lg"})};return r.jsxs("div",{className:z("order-2 mt-auto flex-row justify-between bg-background sm:order-1 sm:mt-0 sm:flex sm:flex-col sm:items-center sm:justify-center sm:p-2",route().current("chats.show")?"hidden":"flex"),children:[r.jsxs(ae,{href:route("chats.index"),className:z("relative flex flex-1 items-center justify-center rounded-lg p-3 transition-all hover:bg-secondary sm:flex-initial",route().current("chats.*")&&"bg-secondary"),children:[r.jsx(Lt,{className:"h-6 w-6"}),s>0&&r.jsx(Bn,{})]}),r.jsx(ae,{href:route("contacts.index"),className:z("flex flex-1 items-center justify-center rounded-lg p-3 transition-all hover:bg-secondary sm:flex-initial",route().current("contacts.*")&&"bg-secondary"),children:r.jsx(Dt,{className:"h-6 w-6"})}),r.jsx(ae,{href:route("archived_chats.index"),className:z("flex flex-1 items-center justify-center rounded-lg p-3 transition-all hover:bg-secondary sm:flex-initial",route().current("archived_chats.*")&&"bg-secondary"),children:r.jsx($t,{className:"h-6 w-6"})}),n<=640?r.jsx(ae,{href:route("preferences.index"),className:z("flex flex-1 items-center justify-center rounded-lg p-3 transition-all hover:bg-secondary sm:flex-initial",route().current("preferences.index")&&"bg-secondary"),children:r.jsx("img",{src:e.avatar,alt:"",className:"h-8 w-8 rounded-full border border-secondary sm:h-10 sm:w-10"})}):r.jsx("div",{className:"relative flex flex-1 cursor-pointer items-center justify-center rounded-lg px-3 transition-all hover:bg-secondary sm:mt-auto sm:flex-initial sm:px-0 sm:hover:bg-transparent",children:r.jsxs(V,{children:[r.jsx(V.Trigger,{children:r.jsx("img",{src:e.avatar,alt:"",className:"h-8 w-8 rounded-full border border-secondary sm:h-10 sm:w-10"})}),r.jsxs(V.Content,{align:"top-left",contentClasses:"mb-12 sm:mb-10",children:[r.jsx(V.Button,{onClick:o,children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(zt,{}),"Preferences"]})}),r.jsx(V.Link,{href:route("profile.edit"),children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Bt,{}),"Profile"]})}),r.jsx(V.Link,{href:route("logout"),method:"post",as:"button",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Ut,{}),"Log out"]})})]})]})})]})}export{xo as A,no as B,so as C,V as D,oo as E,po as F,Un as G,Ln as H,go as M,bo as S,tt as T,rn as _,fo as a,Re as b,ut as c,q as d,lo as e,ht as f,ft as g,ho as h,xe as i,dt as j,co as k,io as l,pt as m,ao as n,un as o,Jt as p,mo as q,Qn as r,ro as s,Zn as t,ge as u,eo as v,to as w,Jn as x,uo as y,vt as z};
